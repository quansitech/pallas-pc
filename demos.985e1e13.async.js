(self.webpackChunk_quansitech_pallas_pc=self.webpackChunk_quansitech_pallas_pc||[]).push([[433],{43752:function(te,O,n){"use strict";n.r(O);var F=n(56413),o=n(24679),P=n(67294),t=n(85893),K={round:function(I,T){var J=Math.pow(10,T);return Math.round(I*J)/J}};O.default=function(){var l=[{title:"\u5F00\u652F\u9879",dataIndex:"budget_name"},{title:"\u5355\u4EF7",component:"InputNumber",dataIndex:"budget_unit_price"},{title:"\u6570\u91CF",component:"InputNumber",dataIndex:"budget_quantity"},{title:"\u8FD9\u9879\u4E0D\u53EF\u4FEE\u6539",component:"Input",dataIndex:"no_update",editable:!1},{title:"\u5C0F\u8BA1",dataIndex:"budget_subtotal",calc:function(_){var L,p;return K.round(parseFloat((L=_==null?void 0:_.budget_unit_price)!==null&&L!==void 0?L:0)*parseFloat((p=_==null?void 0:_.budget_quantity)!==null&&p!==void 0?p:0),2)}},{title:"\u5907\u6CE8",dataIndex:"budget_remark"}],I=[{key:1,budget_name:"\u529E\u516C\u7528\u54C1",budget_unit_price:2,budget_quantity:3,no_update:"\u4E0D\u53EF\u4FEE\u6539\u7684\u503C"},{key:2,budget_name:"\u7ECF\u8D39",budget_unit_price:3,budget_quantity:4,no_update:"\u4E0D\u53EF\u4FEE\u6539\u7684\u503C"}],T=function(_){var L=0;return _.forEach(function(p){var X,m;L+=K.round(((X=p==null?void 0:p.budget_quantity)!==null&&X!==void 0?X:0)*((m=p==null?void 0:p.budget_unit_price)!==null&&m!==void 0?m:0),2)}),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(o.Z.Summary.Row,{children:[(0,t.jsx)(o.Z.Summary.Cell,{index:0,colSpan:4,children:"\u5408\u8BA1"}),(0,t.jsx)(o.Z.Summary.Cell,{index:1,children:(0,t.jsx)("span",{children:L})})]})})};return(0,t.jsx)(F.l0,{name:"editableEditable",initialValues:{data:I},children:(0,t.jsx)(F.l0.Item,{name:"data",children:(0,t.jsx)(F.r8,{columns:l,summary:T,onChange:function(_){console.log(_)}})})})}},64699:function(te,O,n){"use strict";n.r(O);var F=n(15009),o=n.n(F),P=n(99289),t=n.n(P),K=n(5574),l=n.n(K),I=n(56413),T=n(50719),J=n(88385),_=n(97019),L=n(78957),p=n(15867),X=n(67294),m=n(85893);O.default=function(){var de=(0,X.useState)(!1),se=l()(de,2),ie=se[0],$=se[1],ce=I.l0.useForm(),fe=l()(ce,1),le=fe[0],he=function(){var Y=t()(o()().mark(function A(a){return o()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return console.log(a),$(!0),N.next=4,fetch("/api/submit",{method:"POST",body:JSON.stringify(a)});case 4:$(!1);case 5:case"end":return N.stop()}},A)}));return function(a){return Y.apply(this,arguments)}}(),me=function(){var Y=t()(o()().mark(function A(a){var w,N;return o()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return console.log(a),z.next=3,fetch("/api/Staging?name=".concat(a));case 3:return w=z.sent,z.next=6,w.json();case 6:return N=z.sent,z.abrupt("return",N);case 8:case"end":return z.stop()}},A)}));return function(a){return Y.apply(this,arguments)}}(),re=function(){var Y=t()(o()().mark(function A(a){var w;return o()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return console.log(a.form_name,a.form_data),W.next=3,fetch("/api/Staging",{method:"POST",body:JSON.stringify(a)});case 3:return w=W.sent,W.next=6,w.json();case 6:return W.abrupt("return",W.sent);case 7:case"end":return W.stop()}},A)}));return function(a){return Y.apply(this,arguments)}}();return(0,m.jsx)("div",{children:(0,m.jsxs)(I.l0,{name:"assitanceListForm",form:le,labelWrap:!0,labelCol:{span:8},onFinish:he,submitting:ie,children:[(0,m.jsx)(I.l0.Item,{hidden:!0,name:"assistance_list_id",children:(0,m.jsx)(T.Z,{})}),(0,m.jsx)(I.l0.Item,{name:"amount",label:"\u6551\u52A9\u91D1\u989D",rules:[{required:!0}],hasFeedback:!0,children:(0,m.jsx)(J.Z,{addonAfter:"\u5143/\u5E74",min:0,precision:2,controls:!1})}),(0,m.jsx)(I.l0.Item,{name:"start_date",label:"\u5F00\u59CB\u65F6\u95F4",children:(0,m.jsx)(_.Z,{})}),(0,m.jsx)(I.l0.Item,{name:"file",label:"\u6587\u4EF6",children:(0,m.jsx)(I.gq,{action:"/api/upload"})}),(0,m.jsx)(I.l0.Buttons,{draft:!0,form:le,initFn:me,saveFn:re,children:(0,m.jsxs)(L.Z,{children:[(0,m.jsx)(p.ZP,{type:"primary",htmlType:"submit",loading:ie,children:"\u786E\u5B9A"}),(0,m.jsx)(p.ZP,{onClick:function(){},children:"\u53D6\u6D88"})]})})]})})}},35352:function(te,O,n){"use strict";n.r(O);var F=n(56413),o=n(67294),P=n(85893);O.default=function(){var t=function(l){console.log(l)};return(0,P.jsx)("div",{children:(0,P.jsx)(F.gq,{action:"/api/upload?cate=image",tips:"\u4E0A\u4F20\u7EC4\u4EF6",accept:"*",maxCount:1,onChange:t,ifDrag:!0})})}},33198:function(te,O,n){"use strict";n.r(O);var F=n(56413),o=n(67294),P=n(85893);O.default=function(){var t=function(l){console.log(l)};return(0,P.jsx)("div",{children:(0,P.jsx)(F.gq,{action:"/api/upload?cate=image",tips:"\u4E0A\u4F20\u7EC4\u4EF6",accept:"*",maxCount:1,onChange:t})})}},56413:function(te,O,n){"use strict";n.d(O,{zx:function(){return ve},r8:function(){return ze},l0:function(){return ne},gq:function(){return Ie}});var F=n(5574),o=n.n(F),P=n(97857),t=n.n(P),K=n(15009),l=n.n(K),I=n(99289),T=n.n(I),J=n(13769),_=n.n(J),L=n(28459),p=n(87174),X=n(10154),m=n(15867),de=n(27911),se=n(27484),ie=n.n(se),$=n(67294),ce=n(12444),fe=n.n(ce),le=n(72004),he=n.n(le),me=n(9783),re=n.n(me),Y=function(){function j(e,u,r,i){fe()(this,j),re()(this,"id",void 0),re()(this,"uid",void 0),re()(this,"url",void 0),re()(this,"name",void 0),this.id=e,this.uid=u,this.url=r,this.name=i}return he()(j,[{key:"toObject",value:function(){return{id:this.id,uid:this.uid,url:this.url,name:this.name}}},{key:"serialize",value:function(){return{type:"UploadFile",value:this.toObject()}}}],[{key:"isUploadFile",value:function(u){return u instanceof j}}]),j}(),A=Y,a=n(85893),w=["children","submitting","onFinish","readonly"],N=["children","form","draft","initFn","saveFn"],W=function(e){var u=Object.keys(e);return u=u.filter(function(r){var i=e[r];return!!i}),u.length===0},z=function(e){return console.log(e),{type:"dayjs",value:e}},je=function(e){return ie()(e.value)},ge=function(e){return ie().isDayjs(e)?z(e):A.isUploadFile(e)?e.serialize():e},pe=function(e){return(e==null?void 0:e.type)==="dayjs"?je(e):(e==null?void 0:e.type)==="UploadFile"?new A(e.value.id,e.value.uid,e.value.url,e.value.name):e},ne=function(e){var u=e.children,r=e.submitting,i=e.onFinish,f=e.readonly,y=_()(e,w);if(!y.name)throw new Error("Form\u7EC4\u4EF6\u5FC5\u987B\u6307\u5B9Aname\u5C5E\u6027");var B=function(){var b=T()(l()().mark(function v(M){return l()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!r){g.next=2;break}return g.abrupt("return");case 2:if(!i){g.next=5;break}return g.next=5,i(M);case 5:case"end":return g.stop()}},v)}));return function(M){return b.apply(this,arguments)}}();return(0,a.jsx)(L.ZP,{theme:{token:{colorTextDisabled:f?"#000":"rgba(0, 0, 0, 0.25)"}},children:(0,a.jsx)(p.Z,t()(t()({onFinish:B},y),{},{disabled:f,children:u}))})};ne.List=p.Z.List,ne.ErrorList=p.Z.ErrorList,ne.Item=p.Z.Item,ne.useForm=p.Z.useForm,ne.useWatch=p.Z.useWatch;var ye=function(e){var u=e.children,r=e.form,i=e.draft,f=e.initFn,y=e.saveFn,B=_()(e,N),b=(0,$.useState)(!1),v=o()(b,2),M=v[0],h=v[1],g=(0,$.useState)({}),C=o()(g,2),k=C[0],x=C[1],Q=X.ZP.useMessage(),V=o()(Q,2),R=V[0],q=V[1];(0,$.useEffect)(function(){var D=function(){var U=T()(l()().mark(function S(){var s,d,Z,G,c,E;return l()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(typeof f!="function"){ae.next=6;break}return ae.next=3,f(r.__INTERNAL__.name);case 3:if(s=ae.sent,console.log(s),s.status&&s.data){for(d=0,Z=Object.entries(s.data);d<Z.length;d++)G=o()(Z[d],2),c=G[0],E=G[1],Array.isArray(E)?s.data[c]=E.map(function(H){return pe(H)}):s.data[c]=pe(E);x(s.data),h(!0)}case 6:case"end":return ae.stop()}},S)}));return function(){return U.apply(this,arguments)}}();i&&D()},[]);var ee=function(){var D=T()(l()().mark(function U(){var S,s,d,Z,G,c,E,oe;return l()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!W(r.getFieldsValue())){H.next=3;break}return R.error("\u8868\u5355\u4E3A\u7A7A\uFF0C\u6CA1\u6709\u5185\u5BB9\u53EF\u4EE5\u6682\u5B58"),H.abrupt("return");case 3:for(S=r.__INTERNAL__.name,s=r.getFieldsValue(),d=0,Z=Object.entries(s);d<Z.length;d++)G=o()(Z[d],2),c=G[0],E=G[1],Array.isArray(E)?s[c]=E.map(function(Ge){return ge(Ge)}):s[c]=ge(E);if(typeof y!="function"){H.next=11;break}return H.next=9,y({form_name:S,form_data:s});case 9:oe=H.sent,oe.status?R.success("\u6682\u5B58\u6210\u529F"):R.error(oe.info);case 11:case"end":return H.stop()}},U)}));return function(){return D.apply(this,arguments)}}(),ue=function(){r.setFieldsValue(k),h(!1)};return(0,a.jsxs)(a.Fragment,{children:[q,(0,a.jsxs)(p.Z.Item,t()(t()({},B),{},{children:[i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.ZP,{type:"dashed",htmlType:"button",onClick:ee,children:"\u6682\u5B58"}),(0,a.jsx)(de.Z,{title:"\u63D0\u793A",open:M,onOk:ue,onCancel:function(){return h(!1)},children:(0,a.jsx)("p",{children:"\u662F\u5426\u8981\u6062\u590D\u6682\u5B58\u7684\u8868\u5355\u6570\u636E\uFF1F"})})]}),u]}))]})};ne.Buttons=ye;var De=n(19632),Ce=n.n(De),xe=n(56853),Fe=n(21054),Ee=n(10911),_e=n(74956),be=["tips","value","onChange","uploadTo","hashCheck","listType","ifDrag"],Oe=Ee.Z.Dragger,Pe=function(){var j=T()(l()().mark(function e(u){var r;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,n(84805)("./".concat(u));case 2:return r=f.sent,f.abrupt("return",r.default);case 4:case"end":return f.stop()}},e)}));return function(u){return j.apply(this,arguments)}}(),Ie=function(e){var u=e.tips,r=e.value,i=e.onChange,f=i===void 0?function(){}:i,y=e.uploadTo,B=y===void 0?"server":y,b=e.hashCheck,v=b===void 0?!0:b,M=e.listType,h=M===void 0?"picture":M,g=e.ifDrag,C=_()(e,be),k=t()({listType:h},C),x=r==null?void 0:r.map(function(D){return D.toObject()}),Q=X.ZP.useMessage(),V=o()(Q,2),R=V[0],q=V[1],ee=function(){var D=T()(l()().mark(function U(S){var s,d,Z;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(s={file:S,action:C.action,hashId:""},!v){c.next=5;break}return c.next=4,(0,_e.UM)(S);case 4:s.hashId=c.sent;case 5:return c.next=7,Pe(B);case 7:return d=c.sent,c.next=10,d.upload(s.file,s.action,s.hashId);case 10:return Z=c.sent,c.abrupt("return",Z);case 12:case"end":return c.stop()}},U)}));return function(S){return D.apply(this,arguments)}}(),ue=function(){var U=t()(t()({},k),{},{onChange:function(s){var d=s.file;if(d.status==="done")if(d.response.status){var Z=x||[],G={id:d.response.file_id,uid:d.uid,url:d.response.url,name:d.response.title},c=[].concat(Ce()(Z),[G]);C.maxCount===1?c=c.slice(-1):c=c.slice(0,C.maxCount),f(c.map(function(E){return new A(E.id,E.uid,E.url,E.name)}))}else d.response.status===0&&R.error(d.response.info);d.status==="removed"&&f(x.filter(function(E){return E.id!==d.id}).map(function(E){return new A(E.id,E.uid,E.url,E.name)}))},defaultFileList:x,showUploadList:{showDownloadIcon:!0},customRequest:function(s){ee(s.file).then(function(d){s.onSuccess(d)})}});return(0,a.jsxs)(a.Fragment,{children:[q,g?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(Oe,t()(t()({},U),{},{children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(xe.Z,{})}),(0,a.jsx)("p",{className:"ant-upload-text",children:"\u70B9\u51FB\u6216\u62D6\u62FD\u6587\u4EF6\u5230\u6B64\u533A\u57DF\u8FDB\u884C\u4E0A\u4F20"}),(0,a.jsx)("span",{className:"drag-drop-upload-tips",children:u})]}))}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ee.Z,t()(t()({},U),{},{children:(0,a.jsx)(m.ZP,{icon:(0,a.jsx)(Fe.Z,{}),children:"\u70B9\u51FB\u4E0A\u4F20"})})),(0,a.jsx)("span",{style:{color:"#c9c6c6"},children:u})]})]})};return(0,$.useEffect)(function(){v&&(0,_e.ZP)()},[]),(0,a.jsx)(a.Fragment,{children:ue()})},Me=n(24679),Te=n(71230),Ae=n(50719),Be=["onChange"],Ue=function(e){var u=e.onChange,r=_()(e,Be),i=function(y){e.onChange&&e.onChange(y.target.value)};return(0,a.jsx)(Ae.Z,t()({onChange:i},r))},Re=Ue,Se=n(88385),Ze=["onChange"],Le=function(e){var u=e.onChange,r=_()(e,Ze),i=function(y){e.onChange&&e.onChange(y)};return(0,a.jsx)(Se.Z,t()({bordered:!1,onChange:i},r))},$e=Le,We=["children","dataIndex","onChange","component","editable","calc"],Ke={Input:Re,InputNumber:$e},Ne=function(e){var u=e.children,r=e.dataIndex,i=e.onChange,f=e.component,y=f===void 0?"Input":f,B=e.editable,b=e.calc,v=_()(e,We);if(b)return(0,a.jsx)("td",t()(t()({},v),{},{children:b(v.record)}));var M={defaultValue:(v==null?void 0:v.record)&&(v==null?void 0:v.record[r]),onChange:i};return(0,a.jsx)("td",t()(t()({},v),{},{children:B?$.createElement(Ke[y],M):u}))},ze=function(e){var u=e.value,r=e.columns,i=e.onChange,f=e.summary,y=L.ZP.useConfig(),B=y.componentDisabled,b=r.map(function(h){return t()(t()({},h),{},{onCell:function(C){return{record:C,dataIndex:h.dataIndex,title:h.title,component:h==null?void 0:h.component,editable:h.editable===void 0?!0:h.editable,calc:h.calc,onChange:function(x){i&&i(u.map(function(Q,V){return Q.key===C.key&&(Q[h.dataIndex]=x),Q}))}}}})}),v=function(g){return function(){i&&i(u.filter(function(C){return C.key!==g}))}},M=function(){var g=0,C=u!=null?u:[];C.forEach(function(x){x.key>g&&(g=x.key)});var k={};r.forEach(function(x){x.editable===!0&&(k[x.dataIndex]="")}),k.key=g+1,i&&i([].concat(Ce()(C),[k]))};return B||b.push({title:"\u64CD\u4F5C",dataIndex:"operation",editable:!1,width:"40px",render:function(g,C){return(0,a.jsx)(ve,{type:"primary",danger:!0,confirm:{title:"\u5220\u9664",description:"\u786E\u5B9A\u8981\u5220\u9664\u5417?"},onClick:v(C.key),children:"\u5220\u9664"})}}),(0,a.jsx)(Me.Z,{pagination:!1,rowClassName:"budget-td",components:{body:{cell:Ne}},summary:f,footer:function(){return!B&&(0,a.jsx)(Te.Z,{justify:"center",children:(0,a.jsx)(ve,{type:"primary",onClick:M,children:"\u65B0\u589E"})})},dataSource:u,columns:b,bordered:!0})},ke=n(76306),Ve=["children","confirm"],ve=function(e){var u=e.children,r=e.confirm,i=_()(e,Ve),f=(0,$.useState)(!1),y=o()(f,2),B=y[0],b=y[1],v=(0,$.useState)(!1),M=o()(v,2),h=M[0],g=M[1],C=(0,$.useRef)(!1),k=function(R){r||x(R)},x=function(){var V=T()(l()().mark(function R(q){var ee;return l()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(!(!C.current&&i.onClick)){D.next=9;break}return C.current=!0,ee=setTimeout(function(){b(!0),g(!0)},300),D.next=5,i.onClick();case 5:clearTimeout(ee),b(!1),g(!1),C.current=!1;case 9:case"end":return D.stop()}},R)}));return function(q){return V.apply(this,arguments)}}(),Q=function(R){var q=R.children,ee=function(){var ue=T()(l()().mark(function D(U){return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,x(U);case 2:case"end":return s.stop()}},D)}));return function(U){return ue.apply(this,arguments)}}();return r&&!B?(0,a.jsx)(ke.Z,{title:r==null?void 0:r.title,description:r==null?void 0:r.description,onConfirm:ee,okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",children:q}):q};return(0,a.jsx)(Q,{children:(0,a.jsx)(m.ZP,t()(t()({loading:B,disabled:h},i),{},{onClick:k,children:u}))})}},84805:function(te,O,n){var F={"./cos":[13552,552],"./cos.ts":[13552,552],"./oss":[80503,503],"./oss.ts":[80503,503],"./server":[93928,928],"./server.ts":[93928,928],"./tos":[20311,311],"./tos.ts":[20311,311]};function o(P){if(!n.o(F,P))return Promise.resolve().then(function(){var l=new Error("Cannot find module '"+P+"'");throw l.code="MODULE_NOT_FOUND",l});var t=F[P],K=t[0];return n.e(t[1]).then(function(){return n(K)})}o.keys=function(){return Object.keys(F)},o.id=84805,te.exports=o}}]);
