(self.webpackChunk_quansitech_pallas_pc=self.webpackChunk_quansitech_pallas_pc||[]).push([[433],{43752:function(te,A,e){"use strict";e.r(A);var I=e(56413),d=e(24679),B=e(67294),t=e(85893),R={round:function(b,D){var Z=Math.pow(10,D);return Math.round(b*Z)/Z}};A.default=function(){var h=[{title:"\u5F00\u652F\u9879",dataIndex:"budget_name"},{title:"\u5355\u4EF7",component:"InputNumber",dataIndex:"budget_unit_price"},{title:"\u6570\u91CF",component:"InputNumber",customComponentPropsFn:function(c){if((c==null?void 0:c.key)===1)return{max:10}},dataIndex:"budget_quantity"},{title:"\u8FD9\u9879\u4E0D\u53EF\u4FEE\u6539",component:"Input",dataIndex:"no_update",editable:!1},{title:"\u5C0F\u8BA1",dataIndex:"budget_subtotal",calc:function(c){var M,p;return R.round(parseFloat((M=c==null?void 0:c.budget_unit_price)!==null&&M!==void 0?M:0)*parseFloat((p=c==null?void 0:c.budget_quantity)!==null&&p!==void 0?p:0),2)}},{title:"\u5907\u6CE8",dataIndex:"budget_remark"}],b=[{key:1,budget_name:"\u529E\u516C\u7528\u54C1",budget_unit_price:2,budget_quantity:3,no_update:"\u4E0D\u53EF\u4FEE\u6539\u7684\u503C"},{key:2,budget_name:"\u7ECF\u8D39",budget_unit_price:3,budget_quantity:4,no_update:"\u4E0D\u53EF\u4FEE\u6539\u7684\u503C"}],D=function(c){var M=0;return c.forEach(function(p){var Q,f;M+=R.round(((Q=p==null?void 0:p.budget_quantity)!==null&&Q!==void 0?Q:0)*((f=p==null?void 0:p.budget_unit_price)!==null&&f!==void 0?f:0),2)}),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(d.Z.Summary.Row,{children:[(0,t.jsx)(d.Z.Summary.Cell,{index:0,colSpan:4,children:"\u5408\u8BA1"}),(0,t.jsx)(d.Z.Summary.Cell,{index:1,children:(0,t.jsx)("span",{children:M})})]})})};return(0,t.jsx)(I.l0,{name:"editableEditable",initialValues:{data:b},children:(0,t.jsx)(I.l0.Item,{name:"data",children:(0,t.jsx)(I.r8,{columns:h,summary:D,canUpdateNum:"delete_only",onChange:function(c){console.log(c)}})})})}},64699:function(te,A,e){"use strict";e.r(A);var I=e(15009),d=e.n(I),B=e(99289),t=e.n(B),R=e(5574),h=e.n(R),b=e(56413),D=e(50719),Z=e(88385),c=e(97019),M=e(78957),p=e(15867),Q=e(67294),f=e(85893);A.default=function(){var de=(0,Q.useState)(!1),le=h()(de,2),ie=le[0],K=le[1],ce=b.l0.useForm(),me=h()(ce,1),oe=me[0],fe=function(){var Y=t()(d()().mark(function L(a){return d()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return K(!0),V.next=3,fetch("/api/submit",{method:"POST",body:JSON.stringify(a)});case 3:K(!1);case 4:case"end":return V.stop()}},L)}));return function(a){return Y.apply(this,arguments)}}(),he=function(){var Y=t()(d()().mark(function L(a){var q,V;return d()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,fetch("/api/Staging?name=".concat(a));case 2:return q=G.sent,G.next=5,q.json();case 5:return V=G.sent,G.abrupt("return",V);case 7:case"end":return G.stop()}},L)}));return function(a){return Y.apply(this,arguments)}}(),re=function(){var Y=t()(d()().mark(function L(a){var q;return d()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,fetch("/api/Staging",{method:"POST",body:JSON.stringify(a)});case 2:return q=z.sent,z.next=5,q.json();case 5:return z.abrupt("return",z.sent);case 6:case"end":return z.stop()}},L)}));return function(a){return Y.apply(this,arguments)}}();return(0,f.jsx)("div",{children:(0,f.jsxs)(b.l0,{name:"assitanceListForm",form:oe,labelWrap:!0,labelCol:{span:8},onFinish:fe,submitting:ie,children:[(0,f.jsx)(b.l0.Item,{hidden:!0,name:"assistance_list_id",children:(0,f.jsx)(D.Z,{})}),(0,f.jsx)(b.l0.Item,{name:"amount",label:"\u6551\u52A9\u91D1\u989D",rules:[{required:!0}],hasFeedback:!0,children:(0,f.jsx)(Z.Z,{addonAfter:"\u5143/\u5E74",min:0,precision:2,controls:!1})}),(0,f.jsx)(b.l0.Item,{name:"start_date",label:"\u5F00\u59CB\u65F6\u95F4",children:(0,f.jsx)(c.Z,{})}),(0,f.jsx)(b.l0.Item,{name:"file",label:"\u6587\u4EF6",children:(0,f.jsx)(b.gq,{action:"/api/upload"})}),(0,f.jsx)(b.l0.Buttons,{draft:!0,form:oe,initFn:he,saveFn:re,children:(0,f.jsxs)(M.Z,{children:[(0,f.jsx)(p.ZP,{type:"primary",htmlType:"submit",loading:ie,children:"\u786E\u5B9A"}),(0,f.jsx)(p.ZP,{onClick:function(){},children:"\u53D6\u6D88"})]})})]})})}},35352:function(te,A,e){"use strict";e.r(A);var I=e(56413),d=e(67294),B=e(85893);A.default=function(){var t=function(h){};return(0,B.jsx)("div",{children:(0,B.jsx)(I.gq,{action:"/api/upload?cate=image",tips:"\u4E0A\u4F20\u7EC4\u4EF6",accept:"*",maxCount:1,onChange:t,ifDrag:!0})})}},33198:function(te,A,e){"use strict";e.r(A);var I=e(15009),d=e.n(I),B=e(99289),t=e.n(B),R=e(56413),h=e(67294),b=e(15867),D=e(85893);A.default=function(){var Z=function(M){};return(0,D.jsxs)(R.l0,{name:"upload-form",onFinish:function(){var c=t()(d()().mark(function M(p){return d()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:console.log("value",p);case 1:case"end":return f.stop()}},M)}));return function(M){return c.apply(this,arguments)}}(),children:[(0,D.jsx)(R.l0.Item,{name:"upload",label:"\u4E0A\u4F20",rules:[{required:!0}],children:(0,D.jsx)(R.gq,{action:"/api/upload?cate=image",tips:"\u4E0A\u4F20\u7EC4\u4EF6",accept:"*",multiple:!0,onChange:Z})}),(0,D.jsx)(b.ZP,{htmlType:"submit",children:"\u63D0\u4EA4"})]})}},56413:function(te,A,e){"use strict";e.d(A,{zx:function(){return ve},r8:function(){return ke},l0:function(){return ne},gq:function(){return Ie}});var I=e(5574),d=e.n(I),B=e(97857),t=e.n(B),R=e(15009),h=e.n(R),b=e(99289),D=e.n(b),Z=e(13769),c=e.n(Z),M=e(28459),p=e(87174),Q=e(10154),f=e(15867),de=e(27911),le=e(27484),ie=e.n(le),K=e(67294),ce=e(12444),me=e.n(ce),oe=e(72004),fe=e.n(oe),he=e(9783),re=e.n(he),Y=function(){function m(n,i,u,s){me()(this,m),re()(this,"id",void 0),re()(this,"uid",void 0),re()(this,"url",void 0),re()(this,"name",void 0),this.id=n,this.uid=i,this.url=u,this.name=s}return fe()(m,[{key:"toObject",value:function(){return{id:this.id,uid:this.uid,url:this.url,name:this.name}}},{key:"serialize",value:function(){return{type:"UploadFile",value:this.toObject()}}}],[{key:"isUploadFile",value:function(i){return i instanceof m}}]),m}(),L=Y,a=e(85893),q=["children","submitting","onFinish","readonly"],V=["children","form","draft","initFn","saveFn"],z=function(n){var i=Object.keys(n);return i=i.filter(function(u){var s=n[u];return!!s}),i.length===0},G=function(n){return{type:"dayjs",value:n}},je=function(n){return ie()(n.value)},pe=function(n){return ie().isDayjs(n)?G(n):L.isUploadFile(n)?n.serialize():n},_e=function(n){return(n==null?void 0:n.type)==="dayjs"?je(n):(n==null?void 0:n.type)==="UploadFile"?new L(n.value.id,n.value.uid,n.value.url,n.value.name):n},ne=function(n){var i=n.children,u=n.submitting,s=n.onFinish,_=n.readonly,E=c()(n,q);if(!E.name)throw new Error("Form\u7EC4\u4EF6\u5FC5\u987B\u6307\u5B9Aname\u5C5E\u6027");var x=function(){var U=D()(h()().mark(function T(g){return h()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(!u){F.next=2;break}return F.abrupt("return");case 2:if(!s){F.next=5;break}return F.next=5,s(g);case 5:case"end":return F.stop()}},T)}));return function(g){return U.apply(this,arguments)}}();return(0,a.jsx)(M.ZP,{theme:{token:{colorTextDisabled:_?"#000":"rgba(0, 0, 0, 0.25)"}},children:(0,a.jsx)(p.Z,t()(t()({onFinish:x},E),{},{disabled:_,children:i}))})};ne.List=p.Z.List,ne.ErrorList=p.Z.ErrorList,ne.Item=p.Z.Item,ne.useForm=p.Z.useForm,ne.useWatch=p.Z.useWatch;var ye=function(n){var i=n.children,u=n.form,s=n.draft,_=n.initFn,E=n.saveFn,x=c()(n,V),U=(0,K.useState)(!1),T=d()(U,2),g=T[0],N=T[1],F=(0,K.useState)({}),o=d()(F,2),S=o[0],j=o[1],w=Q.ZP.useMessage(),P=d()(w,2),O=P[0],X=P[1];(0,K.useEffect)(function(){var y=function(){var W=D()(h()().mark(function $(){var r,l,k,H,v,C;return h()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(typeof _!="function"){ae.next=5;break}return ae.next=3,_(u.__INTERNAL__.name);case 3:if(r=ae.sent,r.status&&r.data){for(l=0,k=Object.entries(r.data);l<k.length;l++)H=d()(k[l],2),v=H[0],C=H[1],Array.isArray(C)?r.data[v]=C.map(function(J){return _e(J)}):r.data[v]=_e(C);j(r.data),N(!0)}case 5:case"end":return ae.stop()}},$)}));return function(){return W.apply(this,arguments)}}();s&&y()},[]);var ee=function(){var y=D()(h()().mark(function W(){var $,r,l,k,H,v,C,se;return h()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(!z(u.getFieldsValue())){J.next=3;break}return O.error("\u8868\u5355\u4E3A\u7A7A\uFF0C\u6CA1\u6709\u5185\u5BB9\u53EF\u4EE5\u6682\u5B58"),J.abrupt("return");case 3:for($=u.__INTERNAL__.name,r=u.getFieldsValue(),l=0,k=Object.entries(r);l<k.length;l++)H=d()(k[l],2),v=H[0],C=H[1],Array.isArray(C)?r[v]=C.map(function(Ge){return pe(Ge)}):r[v]=pe(C);if(typeof E!="function"){J.next=11;break}return J.next=9,E({form_name:$,form_data:r});case 9:se=J.sent,se.status?O.success("\u6682\u5B58\u6210\u529F"):O.error(se.info);case 11:case"end":return J.stop()}},W)}));return function(){return y.apply(this,arguments)}}(),ue=function(){u.setFieldsValue(S),N(!1)};return(0,a.jsxs)(a.Fragment,{children:[X,(0,a.jsxs)(p.Z.Item,t()(t()({},x),{},{children:[s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.ZP,{type:"dashed",htmlType:"button",onClick:ee,children:"\u6682\u5B58"}),(0,a.jsx)(de.Z,{title:"\u63D0\u793A",open:g,onOk:ue,onCancel:function(){return N(!1)},children:(0,a.jsx)("p",{children:"\u662F\u5426\u8981\u6062\u590D\u6682\u5B58\u7684\u8868\u5355\u6570\u636E\uFF1F"})})]}),i]}))]})};ne.Buttons=ye;var De=e(19632),ge=e.n(De),Pe=e(56853),be=e(21054),Ce=e(10911),Ee=e(74956),xe=["tips","value","onChange","uploadTo","hashCheck","listType","ifDrag"],Fe=Ce.Z.Dragger,Oe=function(){var m=D()(h()().mark(function n(i){var u;return h()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,e(84805)("./".concat(i));case 2:return u=_.sent,_.abrupt("return",u.default);case 4:case"end":return _.stop()}},n)}));return function(i){return m.apply(this,arguments)}}(),Ie=function(n){var i=n.tips,u=n.value,s=n.onChange,_=s===void 0?function(){}:s,E=n.uploadTo,x=E===void 0?"server":E,U=n.hashCheck,T=U===void 0?!0:U,g=n.listType,N=g===void 0?"picture":g,F=n.ifDrag,o=c()(n,xe),S=t()({listType:N},o),j=u==null?void 0:u.map(function(y){return y.toObject()}),w=Q.ZP.useMessage(),P=d()(w,2),O=P[0],X=P[1],ee=function(){var y=D()(h()().mark(function W($){var r,l,k;return h()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(r={file:$,action:o.action,hashId:""},!T){v.next=5;break}return v.next=4,(0,Ee.UM)($);case 4:r.hashId=v.sent;case 5:return v.next=7,Oe(x);case 7:return l=v.sent,v.next=10,l.upload(r.file,r.action,r.hashId);case 10:return k=v.sent,v.abrupt("return",k);case 12:case"end":return v.stop()}},W)}));return function($){return y.apply(this,arguments)}}(),ue=function(){var W=t()(t()({},S),{},{onChange:function(r){var l=r.file;if(l.status==="done")if(l.response.status){var k=j||[],H={id:l.response.file_id,uid:l.uid,url:l.response.url,name:l.response.title},v=[].concat(ge()(k),[H]);o.maxCount===1?v=v.slice(-1):v=v.slice(0,o.maxCount),_(v.map(function(C){return new L(C.id,C.uid,C.url,C.name)}))}else l.response.status===0&&O.error(l.response.info);l.status==="removed"&&_(j.filter(function(C){var se=l.id||l.response.file_id;return C.id!==se}).map(function(C){return new L(C.id,C.uid,C.url,C.name)}))},defaultFileList:j,showUploadList:{showDownloadIcon:!0},onPreview:function(r){var l;window.open((r==null?void 0:r.url)||(r==null||(l=r.response)===null||l===void 0?void 0:l.url),"_blank")},customRequest:function(r){console.log("callbackProps",r),ee(r.file).then(function(l){r.onSuccess(l)})}});return(0,a.jsxs)(a.Fragment,{children:[X,F?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(Fe,t()(t()({},W),{},{children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(Pe.Z,{})}),(0,a.jsx)("p",{className:"ant-upload-text",children:"\u70B9\u51FB\u6216\u62D6\u62FD\u6587\u4EF6\u5230\u6B64\u533A\u57DF\u8FDB\u884C\u4E0A\u4F20"}),(0,a.jsx)("span",{className:"drag-drop-upload-tips",children:i})]}))}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ce.Z,t()(t()({},W),{},{children:(0,a.jsx)(f.ZP,{icon:(0,a.jsx)(be.Z,{}),children:"\u70B9\u51FB\u4E0A\u4F20"})})),(0,a.jsx)("span",{style:{color:"#c9c6c6"},children:i})]})]})};return(0,K.useEffect)(function(){T&&(0,Ee.ZP)()},[]),(0,a.jsx)(a.Fragment,{children:ue()})},Me=e(24679),Te=e(71230),Ae=e(50719),Ue=["onChange"],Be=function(n){var i=n.onChange,u=c()(n,Ue),s=function(E){n.onChange&&n.onChange(E.target.value)};return(0,a.jsx)(Ae.Z,t()({onChange:s},u))},Re=Be,Le=e(88385),Se=["onChange"],We=function(n){var i=n.onChange,u=c()(n,Se),s=function(E){n.onChange&&n.onChange(E)};return(0,a.jsx)(Le.Z,t()({bordered:!1,onChange:s},u))},$e=We,Ze=["children","dataIndex","onChange","component","editable","calc","customComponentProps"],Ke={Input:Re,InputNumber:$e},Ne=(0,K.memo)(function(m){var n=m.children,i=m.dataIndex,u=m.onChange,s=m.component,_=s===void 0?"Input":s,E=m.editable,x=m.calc,U=m.customComponentProps,T=U===void 0?{}:U,g=c()(m,Ze);if(x)return(0,a.jsx)("td",t()(t()({},g),{},{children:x(g.record)}));var N=t()({defaultValue:(g==null?void 0:g.record)&&(g==null?void 0:g.record[i]),onChange:u},T);return(0,a.jsx)("td",t()(t()({},g),{},{children:E?K.createElement(Ke[_],N):n}))}),ke=function(n){var i=n.value,u=n.columns,s=n.onChange,_=n.summary,E=n.canUpdateNum,x=E===void 0?!0:E,U=M.ZP.useConfig(),T=U.componentDisabled,g=u.map(function(o){return t()(t()({},o),{},{onCell:function(j){return{record:j,dataIndex:o.dataIndex,title:o.title,component:o==null?void 0:o.component,editable:o.editable===void 0?!0:o.editable,calc:o.calc,customComponentProps:typeof o.customComponentPropsFn=="function"?o.customComponentPropsFn(j):{},onChange:function(P){s&&s(i.map(function(O,X){return O.key===j.key&&(O[o.dataIndex]=P),O}))}}}})}),N=function(S){return function(){s&&s(i.filter(function(j){return j.key!==S}))}},F=function(){var S=0,j=i!=null?i:[];j.forEach(function(P){P.key>S&&(S=P.key)});var w={};u.forEach(function(P){P.editable===!0&&(w[P.dataIndex]="")}),w.key=S+1,s&&s([].concat(ge()(j),[w]))};return!T&&x&&x!=="add_only"&&g.push({title:"\u64CD\u4F5C",dataIndex:"operation",editable:!1,width:"40px",render:function(S,j){return(0,a.jsx)(ve,{type:"primary",danger:!0,confirm:{title:"\u5220\u9664",description:"\u786E\u5B9A\u8981\u5220\u9664\u5417?"},onClick:N(j.key),children:"\u5220\u9664"})}}),(0,a.jsx)(Me.Z,t()(t()({pagination:!1,rowClassName:"budget-td",components:{body:{cell:Ne}},summary:_},!T&&x&&x!=="delete_only"?{footer:function(){return(0,a.jsx)(Te.Z,{justify:"center",children:(0,a.jsx)(ve,{type:"primary",onClick:F,children:"\u65B0\u589E"})})}}:{}),{},{dataSource:i,columns:g,bordered:!0}))},ze=e(76306),Ve=["children","confirm"],ve=function(n){var i=n.children,u=n.confirm,s=c()(n,Ve),_=(0,K.useState)(!1),E=d()(_,2),x=E[0],U=E[1],T=(0,K.useState)(!1),g=d()(T,2),N=g[0],F=g[1],o=(0,K.useRef)(!1),S=function(O){u||j(O)},j=function(){var P=D()(h()().mark(function O(X){var ee;return h()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(!o.current&&s.onClick)){y.next=9;break}return o.current=!0,ee=setTimeout(function(){U(!0),F(!0)},300),y.next=5,s.onClick();case 5:clearTimeout(ee),U(!1),F(!1),o.current=!1;case 9:case"end":return y.stop()}},O)}));return function(X){return P.apply(this,arguments)}}(),w=function(O){var X=O.children,ee=function(){var ue=D()(h()().mark(function y(W){return h()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,j(W);case 2:case"end":return r.stop()}},y)}));return function(W){return ue.apply(this,arguments)}}();return u&&!x?(0,a.jsx)(ze.Z,{title:u==null?void 0:u.title,description:u==null?void 0:u.description,onConfirm:ee,okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",children:X}):X};return(0,a.jsx)(w,{children:(0,a.jsx)(f.ZP,t()(t()({loading:x,disabled:N},s),{},{onClick:S,children:i}))})}},84805:function(te,A,e){var I={"./cos":[13552,552],"./cos.ts":[13552,552],"./oss":[80503,503],"./oss.ts":[80503,503],"./server":[93928,928],"./server.ts":[93928,928],"./tos":[20311,311],"./tos.ts":[20311,311]};function d(B){if(!e.o(I,B))return Promise.resolve().then(function(){var h=new Error("Cannot find module '"+B+"'");throw h.code="MODULE_NOT_FOUND",h});var t=I[B],R=t[0];return e.e(t[1]).then(function(){return e(R)})}d.keys=function(){return Object.keys(I)},d.id=84805,te.exports=d}}]);
