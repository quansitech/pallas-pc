"use strict";(self.webpackChunk_quansitech_pallas_pc=self.webpackChunk_quansitech_pallas_pc||[]).push([[311],{20311:function(D,m,l){l.r(m);var h=l(15009),f=l.n(h),b=l(99289),c=l.n(b),v=l(44559);m.default={upload:function(){var d=c()(f()().mark(function _(a,n,s){var p,e,u,o,i,g,E,y,T;return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(p=new FormData,e=new URLSearchParams(n),s&&e.append("hash_id",s),u=a.type,u){r.next=8;break}return r.next=7,v.Z.getFileType.start(a);case 7:u=r.sent;case 8:return e.append("vendor_type","volcengine_tos"),e.append("file_type",u),e.append("title",a.name),r.next=13,fetch(decodeURIComponent(e.toString()));case 13:return o=r.sent,r.next=16,o.json();case 16:if(i=r.sent,parseInt(i.status)!==2){r.next=19;break}return r.abrupt("return",{file_id:i.file_id,url:i.file_url,status:parseInt(i.status)});case 19:g=i.params;for(E in g)p.append(E,g[E]);return p.append("file",a),r.next=24,fetch(i.url,{method:"POST",body:p});case 24:return y=r.sent,r.next=27,y.json();case 27:return T=r.sent,r.abrupt("return",T);case 29:case"end":return r.stop()}},_)}));function t(_,a,n){return d.apply(this,arguments)}return t}()}},44559:function(D,m,l){var h=l(15009),f=l.n(h),b=l(99289),c=l.n(b),v={getFileType:{fileToArrayBuffer:function(){var d=c()(f()().mark(function _(a,n){var s;return f()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=new FileReader,s.onload=function(u){if(typeof n=="function")return n(u.target.result)},s.readAsArrayBuffer(a);case 3:case"end":return e.stop()}},_)}));function t(_,a){return d.apply(this,arguments)}return t}(),getFileTypeViaHeader:function(t){for(var _=new Uint8Array(t),a=_.slice(0,4),n=_.slice(0,16),s="",p="",e,u=0;u<a.length;u++)s+=a[u].toString(16);for(var o=0;o<n.length;o++)p+=n[o].toString(16);switch(s){case"89504e47":e="image/png";break;case"47494638":e="image/gif";break;case"ffd8ffDB":case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":case"ffd8ffe3":case"ffd8ffe8":e="image/jpeg";break;case"00020":case"00018":case"00024":case"0001c":p.lastIndexOf("000")===22?e="image/heic":e="unknown";break;default:e="unknown";break}return e},start:function(){var d=c()(f()().mark(function _(a){var n,s;return f()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,s=new Promise(function(u){n.fileToArrayBuffer(a,function(o){var i=n.getFileTypeViaHeader(o);u(i)})}),e.abrupt("return",s);case 3:case"end":return e.stop()}},_,this)}));function t(_){return d.apply(this,arguments)}return t}()},getSuffix:function(t){var _=t.lastIndexOf("."),a="";return _!==-1&&(a=t.substring(_)),a}};m.Z=v}}]);
