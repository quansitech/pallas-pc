(self.webpackChunk_quansitech_pallas_pc=self.webpackChunk_quansitech_pallas_pc||[]).push([[433],{43752:function(te,I,n){"use strict";n.r(I);var b=n(56413),d=n(24679),M=n(67294),t=n(85893),z={round:function(A,B){var Q=Math.pow(10,B);return Math.round(A*Q)/Q}};I.default=function(){var o=[{title:"\u5F00\u652F\u9879",dataIndex:"budget_name"},{title:"\u5355\u4EF7",component:"InputNumber",dataIndex:"budget_unit_price"},{title:"\u6570\u91CF",component:"InputNumber",customComponentProps:{max:10,min:3},dataIndex:"budget_quantity"},{title:"\u8FD9\u9879\u4E0D\u53EF\u4FEE\u6539",component:"Input",dataIndex:"no_update",editable:!1},{title:"\u5C0F\u8BA1",dataIndex:"budget_subtotal",calc:function(g){var W,v;return z.round(parseFloat((W=g==null?void 0:g.budget_unit_price)!==null&&W!==void 0?W:0)*parseFloat((v=g==null?void 0:g.budget_quantity)!==null&&v!==void 0?v:0),2)}},{title:"\u5907\u6CE8",dataIndex:"budget_remark"}],A=[{key:1,budget_name:"\u529E\u516C\u7528\u54C1",budget_unit_price:2,budget_quantity:3,no_update:"\u4E0D\u53EF\u4FEE\u6539\u7684\u503C"},{key:2,budget_name:"\u7ECF\u8D39",budget_unit_price:3,budget_quantity:4,no_update:"\u4E0D\u53EF\u4FEE\u6539\u7684\u503C"}],B=function(g){var W=0;return g.forEach(function(v){var Y,h;W+=z.round(((Y=v==null?void 0:v.budget_quantity)!==null&&Y!==void 0?Y:0)*((h=v==null?void 0:v.budget_unit_price)!==null&&h!==void 0?h:0),2)}),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(d.Z.Summary.Row,{children:[(0,t.jsx)(d.Z.Summary.Cell,{index:0,colSpan:4,children:"\u5408\u8BA1"}),(0,t.jsx)(d.Z.Summary.Cell,{index:1,children:(0,t.jsx)("span",{children:W})})]})})};return(0,t.jsx)(b.l0,{name:"editableEditable",initialValues:{data:A},children:(0,t.jsx)(b.l0.Item,{name:"data",children:(0,t.jsx)(b.r8,{columns:o,summary:B,hasAddBtn:!1,onChange:function(g){console.log(g)}})})})}},64699:function(te,I,n){"use strict";n.r(I);var b=n(15009),d=n.n(b),M=n(99289),t=n.n(M),z=n(5574),o=n.n(z),A=n(56413),B=n(50719),Q=n(88385),g=n(97019),W=n(78957),v=n(15867),Y=n(67294),h=n(85893);I.default=function(){var de=(0,Y.useState)(!1),ie=o()(de,2),se=ie[0],K=ie[1],ce=A.l0.useForm(),fe=o()(ce,1),le=fe[0],me=function(){var w=t()(d()().mark(function U(a){return d()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return console.log(a),K(!0),k.next=4,fetch("/api/submit",{method:"POST",body:JSON.stringify(a)});case 4:K(!1);case 5:case"end":return k.stop()}},U)}));return function(a){return w.apply(this,arguments)}}(),he=function(){var w=t()(d()().mark(function U(a){var q,k;return d()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return console.log(a),V.next=3,fetch("/api/Staging?name=".concat(a));case 3:return q=V.sent,V.next=6,q.json();case 6:return k=V.sent,V.abrupt("return",k);case 8:case"end":return V.stop()}},U)}));return function(a){return w.apply(this,arguments)}}(),re=function(){var w=t()(d()().mark(function U(a){var q;return d()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return console.log(a.form_name,a.form_data),N.next=3,fetch("/api/Staging",{method:"POST",body:JSON.stringify(a)});case 3:return q=N.sent,N.next=6,q.json();case 6:return N.abrupt("return",N.sent);case 7:case"end":return N.stop()}},U)}));return function(a){return w.apply(this,arguments)}}();return(0,h.jsx)("div",{children:(0,h.jsxs)(A.l0,{name:"assitanceListForm",form:le,labelWrap:!0,labelCol:{span:8},onFinish:me,submitting:se,children:[(0,h.jsx)(A.l0.Item,{hidden:!0,name:"assistance_list_id",children:(0,h.jsx)(B.Z,{})}),(0,h.jsx)(A.l0.Item,{name:"amount",label:"\u6551\u52A9\u91D1\u989D",rules:[{required:!0}],hasFeedback:!0,children:(0,h.jsx)(Q.Z,{addonAfter:"\u5143/\u5E74",min:0,precision:2,controls:!1})}),(0,h.jsx)(A.l0.Item,{name:"start_date",label:"\u5F00\u59CB\u65F6\u95F4",children:(0,h.jsx)(g.Z,{})}),(0,h.jsx)(A.l0.Item,{name:"file",label:"\u6587\u4EF6",children:(0,h.jsx)(A.gq,{action:"/api/upload"})}),(0,h.jsx)(A.l0.Buttons,{draft:!0,form:le,initFn:he,saveFn:re,children:(0,h.jsxs)(W.Z,{children:[(0,h.jsx)(v.ZP,{type:"primary",htmlType:"submit",loading:se,children:"\u786E\u5B9A"}),(0,h.jsx)(v.ZP,{onClick:function(){},children:"\u53D6\u6D88"})]})})]})})}},35352:function(te,I,n){"use strict";n.r(I);var b=n(56413),d=n(67294),M=n(85893);I.default=function(){var t=function(o){console.log(o)};return(0,M.jsx)("div",{children:(0,M.jsx)(b.gq,{action:"/api/upload?cate=image",tips:"\u4E0A\u4F20\u7EC4\u4EF6",accept:"*",maxCount:1,onChange:t,ifDrag:!0})})}},33198:function(te,I,n){"use strict";n.r(I);var b=n(56413),d=n(67294),M=n(85893);I.default=function(){var t=function(o){console.log(o)};return(0,M.jsx)("div",{children:(0,M.jsx)(b.gq,{action:"/api/upload?cate=image",tips:"\u4E0A\u4F20\u7EC4\u4EF6",accept:"*",maxCount:1,onChange:t})})}},56413:function(te,I,n){"use strict";n.d(I,{zx:function(){return ve},r8:function(){return ze},l0:function(){return ne},gq:function(){return Ie}});var b=n(5574),d=n.n(b),M=n(97857),t=n.n(M),z=n(15009),o=n.n(z),A=n(99289),B=n.n(A),Q=n(13769),g=n.n(Q),W=n(28459),v=n(87174),Y=n(10154),h=n(15867),de=n(27911),ie=n(27484),se=n.n(ie),K=n(67294),ce=n(12444),fe=n.n(ce),le=n(72004),me=n.n(le),he=n(9783),re=n.n(he),w=function(){function _(e,u,r,s){fe()(this,_),re()(this,"id",void 0),re()(this,"uid",void 0),re()(this,"url",void 0),re()(this,"name",void 0),this.id=e,this.uid=u,this.url=r,this.name=s}return me()(_,[{key:"toObject",value:function(){return{id:this.id,uid:this.uid,url:this.url,name:this.name}}},{key:"serialize",value:function(){return{type:"UploadFile",value:this.toObject()}}}],[{key:"isUploadFile",value:function(u){return u instanceof _}}]),_}(),U=w,a=n(85893),q=["children","submitting","onFinish","readonly"],k=["children","form","draft","initFn","saveFn"],N=function(e){var u=Object.keys(e);return u=u.filter(function(r){var s=e[r];return!!s}),u.length===0},V=function(e){return console.log(e),{type:"dayjs",value:e}},je=function(e){return se()(e.value)},pe=function(e){return se().isDayjs(e)?V(e):U.isUploadFile(e)?e.serialize():e},ge=function(e){return(e==null?void 0:e.type)==="dayjs"?je(e):(e==null?void 0:e.type)==="UploadFile"?new U(e.value.id,e.value.uid,e.value.url,e.value.name):e},ne=function(e){var u=e.children,r=e.submitting,s=e.onFinish,m=e.readonly,C=g()(e,q);if(!C.name)throw new Error("Form\u7EC4\u4EF6\u5FC5\u987B\u6307\u5B9Aname\u5C5E\u6027");var Z=function(){var T=B()(o()().mark(function F(O){return o()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!r){j.next=2;break}return j.abrupt("return");case 2:if(!s){j.next=5;break}return j.next=5,s(O);case 5:case"end":return j.stop()}},F)}));return function(O){return T.apply(this,arguments)}}();return(0,a.jsx)(W.ZP,{theme:{token:{colorTextDisabled:m?"#000":"rgba(0, 0, 0, 0.25)"}},children:(0,a.jsx)(v.Z,t()(t()({onFinish:Z},C),{},{disabled:m,children:u}))})};ne.List=v.Z.List,ne.ErrorList=v.Z.ErrorList,ne.Item=v.Z.Item,ne.useForm=v.Z.useForm,ne.useWatch=v.Z.useWatch;var ye=function(e){var u=e.children,r=e.form,s=e.draft,m=e.initFn,C=e.saveFn,Z=g()(e,k),T=(0,K.useState)(!1),F=d()(T,2),O=F[0],E=F[1],j=(0,K.useState)({}),l=d()(j,2),R=l[0],D=l[1],G=Y.ZP.useMessage(),x=d()(G,2),P=x[0],X=x[1];(0,K.useEffect)(function(){var y=function(){var S=B()(o()().mark(function $(){var i,c,L,H,f,p;return o()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(typeof m!="function"){ae.next=6;break}return ae.next=3,m(r.__INTERNAL__.name);case 3:if(i=ae.sent,console.log(i),i.status&&i.data){for(c=0,L=Object.entries(i.data);c<L.length;c++)H=d()(L[c],2),f=H[0],p=H[1],Array.isArray(p)?i.data[f]=p.map(function(J){return ge(J)}):i.data[f]=ge(p);D(i.data),E(!0)}case 6:case"end":return ae.stop()}},$)}));return function(){return S.apply(this,arguments)}}();s&&y()},[]);var ee=function(){var y=B()(o()().mark(function S(){var $,i,c,L,H,f,p,oe;return o()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(!N(r.getFieldsValue())){J.next=3;break}return P.error("\u8868\u5355\u4E3A\u7A7A\uFF0C\u6CA1\u6709\u5185\u5BB9\u53EF\u4EE5\u6682\u5B58"),J.abrupt("return");case 3:for($=r.__INTERNAL__.name,i=r.getFieldsValue(),c=0,L=Object.entries(i);c<L.length;c++)H=d()(L[c],2),f=H[0],p=H[1],Array.isArray(p)?i[f]=p.map(function(Ge){return pe(Ge)}):i[f]=pe(p);if(typeof C!="function"){J.next=11;break}return J.next=9,C({form_name:$,form_data:i});case 9:oe=J.sent,oe.status?P.success("\u6682\u5B58\u6210\u529F"):P.error(oe.info);case 11:case"end":return J.stop()}},S)}));return function(){return y.apply(this,arguments)}}(),ue=function(){r.setFieldsValue(R),E(!1)};return(0,a.jsxs)(a.Fragment,{children:[X,(0,a.jsxs)(v.Z.Item,t()(t()({},Z),{},{children:[s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.ZP,{type:"dashed",htmlType:"button",onClick:ee,children:"\u6682\u5B58"}),(0,a.jsx)(de.Z,{title:"\u63D0\u793A",open:O,onOk:ue,onCancel:function(){return E(!1)},children:(0,a.jsx)("p",{children:"\u662F\u5426\u8981\u6062\u590D\u6682\u5B58\u7684\u8868\u5355\u6570\u636E\uFF1F"})})]}),u]}))]})};ne.Buttons=ye;var De=n(19632),Ce=n.n(De),xe=n(56853),Fe=n(21054),Ee=n(10911),_e=n(74956),Pe=["tips","value","onChange","uploadTo","hashCheck","listType","ifDrag"],be=Ee.Z.Dragger,Oe=function(){var _=B()(o()().mark(function e(u){var r;return o()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,n(84805)("./".concat(u));case 2:return r=m.sent,m.abrupt("return",r.default);case 4:case"end":return m.stop()}},e)}));return function(u){return _.apply(this,arguments)}}(),Ie=function(e){var u=e.tips,r=e.value,s=e.onChange,m=s===void 0?function(){}:s,C=e.uploadTo,Z=C===void 0?"server":C,T=e.hashCheck,F=T===void 0?!0:T,O=e.listType,E=O===void 0?"picture":O,j=e.ifDrag,l=g()(e,Pe),R=t()({listType:E},l),D=r==null?void 0:r.map(function(y){return y.toObject()}),G=Y.ZP.useMessage(),x=d()(G,2),P=x[0],X=x[1],ee=function(){var y=B()(o()().mark(function S($){var i,c,L;return o()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(i={file:$,action:l.action,hashId:""},!F){f.next=5;break}return f.next=4,(0,_e.UM)($);case 4:i.hashId=f.sent;case 5:return f.next=7,Oe(Z);case 7:return c=f.sent,f.next=10,c.upload(i.file,i.action,i.hashId);case 10:return L=f.sent,f.abrupt("return",L);case 12:case"end":return f.stop()}},S)}));return function($){return y.apply(this,arguments)}}(),ue=function(){var S=t()(t()({},R),{},{onChange:function(i){var c=i.file;if(c.status==="done")if(c.response.status){var L=D||[],H={id:c.response.file_id,uid:c.uid,url:c.response.url,name:c.response.title},f=[].concat(Ce()(L),[H]);l.maxCount===1?f=f.slice(-1):f=f.slice(0,l.maxCount),m(f.map(function(p){return new U(p.id,p.uid,p.url,p.name)}))}else c.response.status===0&&P.error(c.response.info);c.status==="removed"&&m(D.filter(function(p){return p.id!==c.id}).map(function(p){return new U(p.id,p.uid,p.url,p.name)}))},defaultFileList:D,showUploadList:{showDownloadIcon:!0},customRequest:function(i){ee(i.file).then(function(c){i.onSuccess(c)})}});return(0,a.jsxs)(a.Fragment,{children:[X,j?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(be,t()(t()({},S),{},{children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(xe.Z,{})}),(0,a.jsx)("p",{className:"ant-upload-text",children:"\u70B9\u51FB\u6216\u62D6\u62FD\u6587\u4EF6\u5230\u6B64\u533A\u57DF\u8FDB\u884C\u4E0A\u4F20"}),(0,a.jsx)("span",{className:"drag-drop-upload-tips",children:u})]}))}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ee.Z,t()(t()({},S),{},{children:(0,a.jsx)(h.ZP,{icon:(0,a.jsx)(Fe.Z,{}),children:"\u70B9\u51FB\u4E0A\u4F20"})})),(0,a.jsx)("span",{style:{color:"#c9c6c6"},children:u})]})]})};return(0,K.useEffect)(function(){F&&(0,_e.ZP)()},[]),(0,a.jsx)(a.Fragment,{children:ue()})},Me=n(24679),Ae=n(71230),Te=n(50719),Be=["onChange"],Ue=function(e){var u=e.onChange,r=g()(e,Be),s=function(C){e.onChange&&e.onChange(C.target.value)};return(0,a.jsx)(Te.Z,t()({onChange:s},r))},Re=Ue,Se=n(88385),Ze=["onChange"],$e=function(e){var u=e.onChange,r=g()(e,Ze),s=function(C){e.onChange&&e.onChange(C)};return(0,a.jsx)(Se.Z,t()({bordered:!1,onChange:s},r))},Le=$e,We=["children","dataIndex","onChange","component","editable","calc","customComponentProps"],Ke={Input:Re,InputNumber:Le},Ne=function(e){var u=e.children,r=e.dataIndex,s=e.onChange,m=e.component,C=m===void 0?"Input":m,Z=e.editable,T=e.calc,F=e.customComponentProps,O=F===void 0?{}:F,E=g()(e,We);if(T)return(0,a.jsx)("td",t()(t()({},E),{},{children:T(E.record)}));var j=t()({defaultValue:(E==null?void 0:E.record)&&(E==null?void 0:E.record[r]),onChange:s},O);return console.log("componentProps",j),(0,a.jsx)("td",t()(t()({},E),{},{children:Z?K.createElement(Ke[C],j):u}))},ze=function(e){var u=e.value,r=e.columns,s=e.onChange,m=e.summary,C=e.hasAddBtn,Z=C===void 0?!0:C,T=W.ZP.useConfig(),F=T.componentDisabled,O=r.map(function(l){return t()(t()({},l),{},{onCell:function(D){return{record:D,dataIndex:l.dataIndex,title:l.title,component:l==null?void 0:l.component,editable:l.editable===void 0?!0:l.editable,calc:l.calc,customComponentProps:l==null?void 0:l.customComponentProps,onChange:function(x){s&&s(u.map(function(P,X){return P.key===D.key&&(P[l.dataIndex]=x),P}))}}}})}),E=function(R){return function(){s&&s(u.filter(function(D){return D.key!==R}))}},j=function(){var R=0,D=u!=null?u:[];D.forEach(function(x){x.key>R&&(R=x.key)});var G={};r.forEach(function(x){x.editable===!0&&(G[x.dataIndex]="")}),G.key=R+1,s&&s([].concat(Ce()(D),[G]))};return F||O.push({title:"\u64CD\u4F5C",dataIndex:"operation",editable:!1,width:"40px",render:function(R,D){return(0,a.jsx)(ve,{type:"primary",danger:!0,confirm:{title:"\u5220\u9664",description:"\u786E\u5B9A\u8981\u5220\u9664\u5417?"},onClick:E(D.key),children:"\u5220\u9664"})}}),(0,a.jsx)(Me.Z,t()(t()({pagination:!1,rowClassName:"budget-td",components:{body:{cell:Ne}},summary:m},!F&&Z?{footer:function(){return(0,a.jsx)(Ae.Z,{justify:"center",children:(0,a.jsx)(ve,{type:"primary",onClick:j,children:"\u65B0\u589E"})})}}:{}),{},{dataSource:u,columns:O,bordered:!0}))},ke=n(76306),Ve=["children","confirm"],ve=function(e){var u=e.children,r=e.confirm,s=g()(e,Ve),m=(0,K.useState)(!1),C=d()(m,2),Z=C[0],T=C[1],F=(0,K.useState)(!1),O=d()(F,2),E=O[0],j=O[1],l=(0,K.useRef)(!1),R=function(P){r||D(P)},D=function(){var x=B()(o()().mark(function P(X){var ee;return o()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(!l.current&&s.onClick)){y.next=9;break}return l.current=!0,ee=setTimeout(function(){T(!0),j(!0)},300),y.next=5,s.onClick();case 5:clearTimeout(ee),T(!1),j(!1),l.current=!1;case 9:case"end":return y.stop()}},P)}));return function(X){return x.apply(this,arguments)}}(),G=function(P){var X=P.children,ee=function(){var ue=B()(o()().mark(function y(S){return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,D(S);case 2:case"end":return i.stop()}},y)}));return function(S){return ue.apply(this,arguments)}}();return r&&!Z?(0,a.jsx)(ke.Z,{title:r==null?void 0:r.title,description:r==null?void 0:r.description,onConfirm:ee,okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",children:X}):X};return(0,a.jsx)(G,{children:(0,a.jsx)(h.ZP,t()(t()({loading:Z,disabled:E},s),{},{onClick:R,children:u}))})}},84805:function(te,I,n){var b={"./cos":[13552,552],"./cos.ts":[13552,552],"./oss":[80503,503],"./oss.ts":[80503,503],"./server":[93928,928],"./server.ts":[93928,928],"./tos":[20311,311],"./tos.ts":[20311,311]};function d(M){if(!n.o(b,M))return Promise.resolve().then(function(){var o=new Error("Cannot find module '"+M+"'");throw o.code="MODULE_NOT_FOUND",o});var t=b[M],z=t[0];return n.e(t[1]).then(function(){return n(z)})}d.keys=function(){return Object.keys(b)},d.id=84805,te.exports=d}}]);
